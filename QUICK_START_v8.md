# YM2163 Piano GUI v8 - 快速入门指南

## 🚀 立即开始

### 运行程序

```bash
ym2163_piano_gui_v8.exe
```

**观察**：
- ✅ 窗口标题：YM2163 Virtual Piano v8 - Dual YM2163
- ✅ Settings面板中有新选项："Enable 2nd YM2163 (Slot1)"
- ✅ 钢琴键盘右侧显示通道状态和鼓状态

---

## 🆕 v8.0 新特性速览

### 1️⃣ 双YM2163芯片支持

**功能**：启用第二个YM2163芯片（Slot1），将通道数从4扩展到8

**如何启用**：
```
1. 查看Settings面板
2. 找到 "Enable 2nd YM2163 (Slot1)"
3. 勾选启用
4. 查看日志区域确认：
   → "=== Initializing YM2163 Slot0 ==="
   → "=== Initializing YM2163 Slot1 ==="
   → "Dual YM2163 mode active (8 channels)"
```

**视觉验证**：
```
查看钢琴右侧的"Channel Status"
启用前：CH0-CH3
启用后：CH0-CH7 (显示[S0]或[S1]标签)
```

---

### 2️⃣ 通道状态右侧显示

**位置变化**：
- **v7**：Settings面板下方
- **v8**：钢琴键盘右侧

**显示内容**：
```
Channel Status
--------------
[S0] CH0: C4 [Piano/Fast/0dB]
[S0] CH1: E4 [Piano/Fast/0dB]
[S1] CH4: G4 [Piano/Fast/0dB]  <- Slot1通道
...

Drum Status
-----------
BD  HC  SDN  HHO  HHD
```

**颜色说明**：
- **绿色** [S0] - Slot0（第一芯片）
- **蓝色** [S1] - Slot1（第二芯片）
- **灰色** - 未使用通道

---

## 🎹 测试双芯片功能

### 测试步骤 1：启用第二芯片

```
1. 打开程序
2. Settings → 勾选 "Enable 2nd YM2163 (Slot1)"
3. 观察日志：
   ✓ "Initializing YM2163 Slot0"
   ✓ "Initializing YM2163 Slot1"
   ✓ "Dual YM2163 mode active (8 channels)"
```

---

### 测试步骤 2：单键盘演奏（观察通道分配）

**测试1：4个音符**
```
同时按键盘：A S D F
查看通道状态：
→ [S0] CH0: C   (Slot0通道0)
→ [S0] CH1: D   (Slot0通道1)
→ [S0] CH2: E   (Slot0通道2)
→ [S0] CH3: F   (Slot0通道3)

结论：前4个音符使用Slot0
```

**测试2：8个音符（复音测试）**
```
同时按键盘：A W S E D F T G
查看通道状态：
→ [S0] CH0: C   (Slot0)
→ [S0] CH1: C#  (Slot0)
→ [S0] CH2: D   (Slot0)
→ [S0] CH3: D#  (Slot0)
→ [S1] CH4: E   (Slot1) ← 第5个音符使用Slot1
→ [S1] CH5: F   (Slot1)
→ [S1] CH6: F#  (Slot1)
→ [S1] CH7: G   (Slot1)

结论：8个音符同时发声，复音能力翻倍！
```

---

### 测试步骤 3：MIDI文件播放（自动分配）

```
1. 加载一个复杂的MIDI文件（多音符同时发声）
2. 点击播放
3. 观察通道状态：
   → 音符自动分配到8个通道
   → 颜色交替出现（绿[S0]/蓝[S1]）
   → 当8个通道全满时，最早的音符被替换
```

---

### 测试步骤 4：禁用第二芯片

```
1. 取消勾选 "Enable 2nd YM2163 (Slot1)"
2. 观察：
   → Slot1通道停止
   → 通道数量恢复为4
   → CH4-CH7灰显
   → 日志显示："Second YM2163 disabled - 4 channels only"
3. 继续演奏：只使用CH0-CH3

结论：可以灵活切换单/双芯片模式
```

---

## 📊 v7 vs v8 功能对比

### 通道数量对比

| 版本 | 通道数 | 最大复音 | 芯片 |
|------|--------|----------|------|
| v7 | 4 | 4个音符 | 1个 |
| v8 | 8 | 8个音符 | 2个 |

**复音能力提升**：200%

---

### UI布局对比

**v7布局**：
```
Settings面板下方：
├─ Channel Status (CH0-CH3)
└─ Drum Status (5个鼓)
```

**v8布局**：
```
钢琴键盘右侧：
├─ Channel Status (CH0-CH7)
└─ Drum Status (5个鼓)
```

**优势**：
- 更紧凑的布局
- 更直观的状态显示
- 减少垂直滚动

---

## 💡 使用技巧

### 技巧 1：何时启用第二芯片

**推荐场景**：
- ✅ 播放复杂的MIDI文件（多音轨）
- ✅ 键盘实时演奏和弦（>4个音符）
- ✅ 需要更丰富的音色变化
- ✅ 多人协作演奏

**不推荐场景**：
- ❌ 简单的单音旋律
- ❌ 鼓声为主的音乐
- ❌ 硬件不支持Slot1

---

### 技巧 2：识别芯片来源

**快速识别**：
```
通道颜色标识：
🟢 [S0] - 来自Slot0（第一芯片）
🔵 [S1] - 来自Slot1（第二芯片）
⚪ --- - 未使用
```

**用途**：
- 调试硬件连接
- 了解音符分配策略
- 验证双芯片工作状态

---

### 技巧 3：最大化复音能力

**方法**：
```
1. 启用第二芯片
2. 使用自动跳过静音功能（减少空闲通道）
3. 使用MIDI文件而非实时键盘（更精确的时序）
4. 保持连接线短且稳定（减少通信干扰）
```

**预期效果**：
- 8个音符同时发声
- 更丰富的和弦
- 更复杂的音乐表现

---

### 技巧 4：监控通道分配

**实时观察**：
```
播放MIDI文件时，观察通道状态：
1. 音符开始 → 通道从灰色变为彩色
2. 音符持续 → 显示音符名称和参数
3. 音符结束 → 通道变回灰色
4. 通道切换 → Slot0和Slot1交替使用
```

**分析通道利用率**：
- 如果频繁看到8个通道全满 → 受益于双芯片
- 如果只用到4个通道 → 单芯片足够

---

## 🎹 快速操作指南

### 键盘演奏

| 按键 | 音符 | 显示颜色 | 芯片 |
|------|------|----------|------|
| A | C (Do) | 绿色 [S0] | Slot0 |
| S | D (Re) | 绿色 [S0] | Slot0 |
| D | E (Mi) | 绿色 [S0] | Slot0 |
| F | F (Fa) | 绿色 [S0] | Slot0 |
| G | G (Sol) | 蓝色 [S1] | Slot1 ← 第5个音符 |
| H | A (La) | 蓝色 [S1] | Slot1 |

---

### 双芯片控制

| 操作 | 方法 | 结果 |
|------|------|------|
| 启用第二芯片 | 勾选Settings | 8通道激活 |
| 禁用第二芯片 | 取消勾选 | 4通道，Slot1停止 |
| 查看芯片状态 | 观察通道颜色 | [S0]绿色/[S1]蓝色 |
| 查看日志 | 查看Log区域 | 初始化消息 |

---

## 🐛 故障排除

### 问题 1：第二芯片无法启用

**可能原因**：
- 硬件不支持Slot1
- FT2232连接问题
- SPFM配置错误

**解决方法**：
```
1. 检查硬件是否支持SPFM Slot1
2. 重新连接FT2232
3. 查看日志区域的错误信息
4. 重启程序
```

---

### 问题 2：只看到Slot0通道

**可能原因**：
- 第二芯片未勾选启用
- 音符数量 ≤ 4

**解决方法**：
```
1. 确认Settings中已勾选 "Enable 2nd YM2163 (Slot1)"
2. 同时播放5个或以上音符
3. 查看通道状态是否出现[S1]
```

---

### 问题 3：通道状态颜色异常

**可能原因**：
- 通道状态未正确更新
- 芯片索引错误

**解决方法**：
```
1. 停止所有播放
2. 取消勾选并重新勾选第二芯片
3. 查看日志确认重新初始化
4. 重启程序
```

---

### 问题 4：8个音符后音符消失

**期望行为**：
这是正常的！当8个通道全满时，新音符会替换最早或优先级最低的音符。

**FIFO替换策略**：
1. 替换超出有效范围的音符
2. 替换已播放足够时间的音符（>50ms）
3. 保护最高和最低音符
4. 优先替换低音符

---

## 📋 文件说明

### 程序文件

| 文件名 | 说明 | 必需性 |
|--------|------|--------|
| ym2163_piano_gui_v8.exe | v8主程序 | ✅ 必需 |
| ym2163_midi_config.ini | MIDI配置 | ✅ 必需 |
| ym2163_folder_history.ini | 历史记录 | ❌ 自动生成 |
| ym2163_tuning.ini | 调音配置 | ❌ 自动生成 |

---

### 文档文件

| 文件名 | 说明 |
|--------|------|
| UPDATE_v8_NOTES.md | v8完整技术文档 |
| QUICK_START_v8.md | 本快速入门指南 |
| UPDATE_v7_NOTES.md | v7更新说明（参考） |
| QUICK_START_v7.md | v7快速入门（参考） |

---

## 🎉 使用场景示例

### 场景 1：实时演奏复杂和弦

**目标**：同时演奏8个音符的和弦

**步骤**：
```
1. 启用第二芯片
2. 同时按键盘：A W S E D F T G (8个键)
3. 观察：
   → 8个音符同时发声
   → 前4个[S0]，后4个[S1]
   → 和弦饱满、丰富
```

**效果**：v7只能演奏4音和弦，v8可演奏8音和弦

---

### 场景 2：播放多音轨MIDI文件

**目标**：播放包含钢琴+弦乐的MIDI文件

**步骤**：
```
1. 启用第二芯片
2. 加载复杂MIDI文件
3. 点击播放
4. 观察：
   → 钢琴音符分配到Slot0
   → 弦乐音符分配到Slot1
   → 音色区分明显
```

**效果**：更多音符同时发声，音乐更完整

---

### 场景 3：双人协作演奏

**目标**：两人同时演奏不同音域

**步骤**：
```
1. 启用第二芯片
2. 人A: 演奏低音（通道0-3）
3. 人B: 演奏高音（通道4-7）
4. 观察：
   → [S0]通道显示低音
   → [S1]通道显示高音
   → 互不干扰
```

**效果**：协作演奏更流畅，无需担心通道冲突

---

## 🎉 开始使用

现在你已经了解了v8的所有新特性，开始享受：

- ✅ **8通道复音** - 复音能力翻倍
- ✅ **双芯片支持** - Slot0和Slot1
- ✅ **动态切换** - 灵活启用/禁用
- ✅ **直观状态** - 钢琴右侧实时显示
- ✅ **芯片感知** - 清晰的颜色标识

加上v7的所有功能：
- ✅ Unicode路径、全局媒体键、自动跳过静音
- ✅ 文件夹历史、力度可视化、颜色区分
- ✅ 输入保护、日志增强、整洁GUI

---

**版本**：v8.0 Dual Chip Edition
**祝你使用愉快！🎵**

如果需要更详细的技术说明，请参阅：
- UPDATE_v8_NOTES.md - 完整技术文档
- UPDATE_v7_NOTES.md - v7功能文档
